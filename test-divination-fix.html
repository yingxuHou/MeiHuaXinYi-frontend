<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å åœæŒ‰é’®ä¿®å¤éªŒè¯ - æ¢…èŠ±å¿ƒæ˜“</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .step {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .step h3 {
            color: #fbbf24;
            margin-top: 0;
        }
        .btn {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1e3a8a;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
        }
        .btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }
        .status.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
        }
        .status.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        .status.warning {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #f59e0b;
        }
        .checklist {
            list-style: none;
            padding: 0;
        }
        .checklist li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .checklist li:before {
            content: "âœ… ";
            color: #10b981;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”® å åœæŒ‰é’®ä¿®å¤éªŒè¯</h1>
        
        <div class="step">
            <h3>ğŸ“‹ ä¿®å¤å†…å®¹æ€»ç»“</h3>
            <ul class="checklist">
                <li>è®¾ç½®é»˜è®¤é—®é¢˜åˆ†ç±»ä¸º"å…¶ä»–é—®é¢˜"</li>
                <li>æ·»åŠ æ™ºèƒ½æŒ‰é’®æ–‡æœ¬æç¤º</li>
                <li>æ”¹è¿›ç”¨æˆ·ä½“éªŒå’Œé”™è¯¯æç¤º</li>
                <li>ä¿æŒæ‰€æœ‰éªŒè¯é€»è¾‘ä¸å˜</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ§ª æµ‹è¯•æ­¥éª¤</h3>
            <p><strong>æ­¥éª¤1ï¼šè®¾ç½®ç™»å½•çŠ¶æ€</strong></p>
            <button class="btn" onclick="setupLogin()">ğŸ”‘ è®¾ç½®ç™»å½•çŠ¶æ€</button>
            <div id="loginStatus" class="status warning">è¯·å…ˆè®¾ç½®ç™»å½•çŠ¶æ€</div>
            
            <p><strong>æ­¥éª¤2ï¼šè®¿é—®å åœé¡µé¢</strong></p>
            <a href="http://localhost:5173/divination/question" class="btn" target="_blank">ğŸ“ æ‰“å¼€å åœé¡µé¢</a>
            <p style="font-size: 14px; color: rgba(255,255,255,0.7);">
                æ³¨æ„ï¼šå¦‚æœé¡µé¢è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œè¯´æ˜ç™»å½•çŠ¶æ€æœªæ­£ç¡®è®¾ç½®
            </p>
            
            <p><strong>æ­¥éª¤3ï¼šæµ‹è¯•æŒ‰é’®åŠŸèƒ½</strong></p>
            <ol style="font-size: 14px; color: rgba(255,255,255,0.8);">
                <li>é¡µé¢åŠ è½½åï¼ŒæŒ‰é’®åº”è¯¥æ˜¾ç¤º"è¯·è¾“å…¥æ‚¨çš„é—®é¢˜"</li>
                <li>è¾“å…¥1-4ä¸ªå­—ç¬¦ï¼ŒæŒ‰é’®åº”è¯¥æ˜¾ç¤º"è¯·è¾“å…¥è‡³å°‘5ä¸ªå­—ç¬¦"</li>
                <li>è¾“å…¥5ä¸ªæˆ–æ›´å¤šå­—ç¬¦ï¼ŒæŒ‰é’®åº”è¯¥å˜ä¸º"å¼€å§‹å åœ"å¹¶å¯ç‚¹å‡»</li>
                <li>ç‚¹å‡»æŒ‰é’®åº”è¯¥è·³è½¬åˆ°åŠ è½½é¡µé¢</li>
            </ol>
        </div>

        <div class="step">
            <h3>ğŸ” é—®é¢˜è¯Šæ–­å·¥å…·</h3>
            <p>å¦‚æœæŒ‰é’®ä»ç„¶æ— æ³•ç‚¹å‡»ï¼Œè¯·ä½¿ç”¨è¯Šæ–­å·¥å…·ï¼š</p>
            <a href="http://localhost:5173/divination-button-debug.html" class="btn secondary" target="_blank">ğŸ› ï¸ æ‰“å¼€è¯Šæ–­å·¥å…·</a>
        </div>

        <div class="step">
            <h3>ğŸ“Š é¢„æœŸè¡Œä¸º</h3>
            <div class="status success">
                <strong>ä¿®å¤åçš„é¢„æœŸè¡Œä¸ºï¼š</strong><br>
                1. é¡µé¢åŠ è½½æ—¶ï¼Œåˆ†ç±»é»˜è®¤é€‰æ‹©"å…¶ä»–é—®é¢˜"<br>
                2. æŒ‰é’®æ–‡æœ¬ä¼šæ ¹æ®å½“å‰çŠ¶æ€æ˜¾ç¤ºä¸åŒæç¤º<br>
                3. ç”¨æˆ·åªéœ€è¾“å…¥5ä¸ªå­—ç¬¦ä»¥ä¸Šçš„é—®é¢˜å³å¯å¯ç”¨æŒ‰é’®<br>
                4. æŒ‰é’®ç‚¹å‡»åæ­£å¸¸è·³è½¬åˆ°å åœæµç¨‹
            </div>
        </div>

        <div class="step">
            <h3>ğŸš¨ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨</h3>
            <div class="status error">
                <strong>å¯èƒ½çš„åŸå› ï¼š</strong><br>
                1. å‰ç«¯ä»£ç æœªé‡æ–°åŠ è½½ - è¯·åˆ·æ–°é¡µé¢æˆ–é‡å¯å‰ç«¯æœåŠ¡å™¨<br>
                2. ç”¨æˆ·æœªç™»å½• - è¯·ç¡®ä¿å·²è®¾ç½®ç™»å½•çŠ¶æ€<br>
                3. å…è´¹æ¬¡æ•°ä¸º0 - è¯·æ£€æŸ¥ç”¨æˆ·çš„å…è´¹å åœæ¬¡æ•°<br>
                4. æµè§ˆå™¨ç¼“å­˜ - è¯·æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼
            </div>
            
            <button class="btn secondary" onclick="clearCache()">ğŸ—‘ï¸ æ¸…é™¤ç¼“å­˜</button>
            <button class="btn secondary" onclick="checkFrontendServer()">ğŸ” æ£€æŸ¥å‰ç«¯æœåŠ¡å™¨</button>
        </div>
    </div>

    <script>
        function setupLogin() {
            // è®¾ç½®æ¨¡æ‹Ÿç™»å½•çŠ¶æ€
            const mockToken = 'mock_token_' + Date.now();
            const mockUser = {
                id: 'mock_user_' + Date.now(),
                username: 'test_user',
                email: 'test@example.com',
                freeCount: 3,
                isEmailVerified: true,
                createdAt: new Date().toISOString()
            };
            
            // è®¾ç½®å¤šç§å¯èƒ½çš„å­˜å‚¨é”®å
            localStorage.setItem('token', mockToken);
            localStorage.setItem('authToken', mockToken);
            localStorage.setItem('userInfo', JSON.stringify(mockUser));
            localStorage.setItem('freeCount', '3');
            
            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
            document.getElementById('loginStatus').innerHTML = 
                '<div class="status success">âœ… ç™»å½•çŠ¶æ€å·²è®¾ç½®ï¼ç”¨æˆ·å: test_userï¼Œå…è´¹æ¬¡æ•°: 3</div>';
            
            console.log('ç™»å½•çŠ¶æ€å·²è®¾ç½®:', {
                token: mockToken,
                user: mockUser
            });
        }

        function clearCache() {
            // æ¸…é™¤æ‰€æœ‰ç›¸å…³çš„æœ¬åœ°å­˜å‚¨
            const keys = ['token', 'authToken', 'userInfo', 'freeCount', 'refreshToken'];
            keys.forEach(key => localStorage.removeItem(key));
            
            // æ¸…é™¤ä¼šè¯å­˜å‚¨
            sessionStorage.clear();
            
            alert('ç¼“å­˜å·²æ¸…é™¤ï¼è¯·é‡æ–°è®¾ç½®ç™»å½•çŠ¶æ€ã€‚');
            
            // é‡ç½®çŠ¶æ€æ˜¾ç¤º
            document.getElementById('loginStatus').innerHTML = 
                '<div class="status warning">è¯·å…ˆè®¾ç½®ç™»å½•çŠ¶æ€</div>';
        }

        async function checkFrontendServer() {
            try {
                const response = await fetch('http://localhost:5173/');
                if (response.ok) {
                    alert('âœ… å‰ç«¯æœåŠ¡å™¨è¿è¡Œæ­£å¸¸');
                } else {
                    alert('âš ï¸ å‰ç«¯æœåŠ¡å™¨å“åº”å¼‚å¸¸');
                }
            } catch (error) {
                alert('âŒ æ— æ³•è¿æ¥å‰ç«¯æœåŠ¡å™¨: ' + error.message);
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥å½“å‰ç™»å½•çŠ¶æ€
        window.addEventListener('load', () => {
            const token = localStorage.getItem('token') || localStorage.getItem('authToken');
            const userInfo = localStorage.getItem('userInfo');
            
            if (token && userInfo) {
                try {
                    const user = JSON.parse(userInfo);
                    document.getElementById('loginStatus').innerHTML = 
                        `<div class="status success">âœ… å·²æœ‰ç™»å½•çŠ¶æ€ï¼ç”¨æˆ·: ${user.username || user.email}ï¼Œå…è´¹æ¬¡æ•°: ${user.freeCount || 0}</div>`;
                } catch (error) {
                    document.getElementById('loginStatus').innerHTML = 
                        '<div class="status warning">ç™»å½•æ•°æ®æ ¼å¼é”™è¯¯ï¼Œè¯·é‡æ–°è®¾ç½®</div>';
                }
            }
        });
    </script>
</body>
</html>
